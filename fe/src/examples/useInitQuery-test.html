<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>useInitQuery ApiResult æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
        }
        .test-title {
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 10px;
        }
        .code-block {
            background: #f8f8f8;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        .success {
            color: #28a745;
        }
        .error {
            color: #dc3545;
        }
        .info {
            color: #17a2b8;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ useInitQuery RequestResult é›†æˆæ¸¬è©¦</h1>
        
        <div class="highlight">
            <strong>ğŸ“ èªªæ˜ï¼š</strong> æ­¤é é¢å±•ç¤º useInitQuery.ts å¦‚ä½•ä½¿ç”¨æ–°çš„ RequestResult çµ±ä¸€è™•ç†ç³»çµ±ã€‚
            è«‹æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·æŸ¥çœ‹æ§åˆ¶å°è¼¸å‡ºã€‚
        </div>

        <div class="test-section">
            <div class="test-title">âœ… å·²å®Œæˆçš„æ”¹é€²</div>
            <ul>
                <li><strong>çµ±ä¸€éŒ¯èª¤è™•ç†ï¼š</strong> æ‰€æœ‰ API å‡½æ•¸ç¾åœ¨ä½¿ç”¨ <code>apiClient.postWithResult()</code></li>
                <li><strong>è©³ç´°æ—¥èªŒè¨˜éŒ„ï¼š</strong> ä½¿ç”¨ <code>result.logSuccess()</code> å’Œ <code>result.logError()</code></li>
                <li><strong>ä¸­æ–‡åŒ–è¨Šæ¯ï¼š</strong> æ‰€æœ‰æˆåŠŸ/éŒ¯èª¤è¨Šæ¯éƒ½ä½¿ç”¨ç¹é«”ä¸­æ–‡ä¸¦åŠ ä¸Šè¡¨æƒ…ç¬¦è™Ÿ</li>
                <li><strong>å¢å¼·èª¿è©¦ï¼š</strong> åœ¨éŒ¯èª¤æ™‚é¡¯ç¤ºè©³ç´°çš„éŒ¯èª¤è³‡è¨Š</li>
            </ul>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ” API å‡½æ•¸æ”¹é€²ç¤ºä¾‹</div>
            <div class="code-block">// èˆŠç‰ˆæœ¬ï¼ˆä½¿ç”¨å‚³çµ± try-catchï¼‰
const initRbacDemoAPI = async (): Promise&lt;InitResponse&gt; => {
  try {
    const response = await apiClient.post&lt;InitResponse&gt;('/api/init/rbac-demo');
    return response;
  } catch (error: any) {
    console.error('Failed to initialize RBAC demo:', error);
    throw { message: error.response?.data?.message || 'Failed to initialize RBAC demo' };
  }
};

// æ–°ç‰ˆæœ¬ï¼ˆä½¿ç”¨ RequestResultï¼‰
const initRbacDemoAPI = async (): Promise&lt;InitResponse&gt; => {
  const result = await apiClient.postWithResult&lt;InitResponse&gt;('/api/init/rbac-demo');
  
  if (result.isSuccess() && result.data) {
    result.logSuccess('RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–');
    return result.data;
  } else {
    result.logError('RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–å¤±æ•—');
    throw {
      message: result.message || 'Failed to initialize RBAC demo',
      status: result.status,
      details: result.error,
    } as InitError;
  }
};</div>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ“Š Mutation Hook æ”¹é€²</div>
            <div class="code-block">// æ”¹é€²çš„æˆåŠŸè™•ç†
onSuccess: (data) => {
  console.log('âœ… RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–æˆåŠŸ:', data.message);
  queryClient.invalidateQueries({ queryKey: ['rbac'] });
},

// æ”¹é€²çš„éŒ¯èª¤è™•ç†
onError: (error: InitError) => {
  console.error('âŒ RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–å¤±æ•—:', error.message);
  if (error.details) {
    console.error('éŒ¯èª¤è©³æƒ…:', error.details);
  }
},</div>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ¯ èª¿è©¦å„ªå‹¢</div>
            <div class="code-block">// åœ¨æ§åˆ¶å°ä¸­ä½ æœƒçœ‹åˆ°é€™æ¨£çš„æ—¥èªŒï¼š

<span class="success">âœ… RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–æˆåŠŸ: Demo data created successfully</span>
<span class="info">ğŸ“Š é€²åº¦è¿½è¹¤ URL: /api/progress/abc123</span>
<span class="success">ğŸ‰ æ‰€æœ‰ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–æˆåŠŸ:</span>
<span class="success">  âœ… RBAC: Demo data created successfully</span>
<span class="success">  âœ… RTK: RTK data initialized</span>

// éŒ¯èª¤æ™‚çš„è©³ç´°ä¿¡æ¯ï¼š
<span class="error">âŒ RBAC ç¤ºä¾‹è³‡æ–™åˆå§‹åŒ–å¤±æ•—: Database connection failed</span>
<span class="error">éŒ¯èª¤è©³æƒ…: { status: 500, details: { ... } }</span></div>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ§ª æ¸¬è©¦æ–¹æ³•</div>
            <div class="highlight">
                <p><strong>å¦‚ä½•æ¸¬è©¦ï¼š</strong></p>
                <ol>
                    <li>ç¢ºèªå¾Œç«¯æœå‹™æ­£åœ¨é‹è¡Œ</li>
                    <li>åœ¨å‰ç«¯æ‡‰ç”¨ä¸­ä½¿ç”¨ä»»ä½•åˆå§‹åŒ–åŠŸèƒ½</li>
                    <li>æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12)</li>
                    <li>æŸ¥çœ‹æ§åˆ¶å°ä¸­çš„å½©è‰²æ—¥èªŒè¼¸å‡º</li>
                    <li>æ³¨æ„æˆåŠŸ/éŒ¯èª¤è¨Šæ¯çš„æ ¼å¼å’Œè©³ç´°ç¨‹åº¦</li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ“ˆ æ•ˆèƒ½å„ªå‹¢</div>
            <ul>
                <li><strong>é¡å‹å®‰å…¨ï¼š</strong> å®Œæ•´çš„ TypeScript é¡å‹æ”¯æ´</li>
                <li><strong>çµ±ä¸€ä»‹é¢ï¼š</strong> æ‰€æœ‰ API è«‹æ±‚éƒ½æœ‰ä¸€è‡´çš„è™•ç†æ–¹å¼</li>
                <li><strong>æ›´å¥½çš„èª¿è©¦ï¼š</strong> çµæ§‹åŒ–çš„éŒ¯èª¤ä¿¡æ¯å’ŒæˆåŠŸæ—¥èªŒ</li>
                <li><strong>å‘å¾Œå…¼å®¹ï¼š</strong> ä¸æœƒç ´å£ç¾æœ‰çš„åŠŸèƒ½</li>
                <li><strong>ç¶­è­·æ€§ï¼š</strong> é›†ä¸­çš„éŒ¯èª¤è™•ç†é‚è¼¯</li>
            </ul>
        </div>

        <div class="test-section">
            <div class="test-title">ğŸ”— ç›¸é—œæª”æ¡ˆ</div>
            <ul>
                <li><code>/fe/src/utils/RequestResult.ts</code> - æ ¸å¿ƒ RequestResult é¡åˆ¥</li>
                <li><code>/fe/src/utils/RequestUtils.ts</code> - æ“´å±•çš„è«‹æ±‚å·¥å…·</li>
                <li><code>/fe/src/hooks/useInitQuery.ts</code> - æ›´æ–°çš„åˆå§‹åŒ– Hooks</li>
                <li><code>/fe/src/hooks/useAuthQuery.ts</code> - æ›´æ–°çš„èªè­‰ Hooks</li>
                <li><code>/fe/src/examples/RequestResult-Usage-Examples.md</code> - ä½¿ç”¨æ–‡æª”</li>
            </ul>
        </div>
    </div>

    <script>
        // ç°¡å–®çš„æ§åˆ¶å°æ¸¬è©¦
        console.log('%cğŸ‰ useInitQuery RequestResult é›†æˆæ¸¬è©¦é é¢å·²è¼‰å…¥', 'color: #28a745; font-weight: bold; font-size: 16px;');
        console.log('%câœ… æ‰€æœ‰ API å‡½æ•¸ç¾åœ¨éƒ½ä½¿ç”¨çµ±ä¸€çš„ RequestResult è™•ç†', 'color: #17a2b8;');
        console.log('%cğŸ“Š è«‹åœ¨å¯¦éš›æ‡‰ç”¨ä¸­æ¸¬è©¦åˆå§‹åŒ–åŠŸèƒ½ä»¥æŸ¥çœ‹æ”¹é€²å¾Œçš„æ—¥èªŒ', 'color: #6f42c1;');
    </script>
</body>
</html>